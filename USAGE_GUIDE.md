# UnlockOpenFile 사용 가이드

## 빠른 시작

### 1단계: 프로그램 빌드
```bash
dotnet publish -c Release -r win-x64 --self-contained false -o ./publish
```

### 2단계: 실행 파일 위치
빌드 후 `publish/UnlockOpenFile.exe` 파일을 원하는 위치에 복사합니다.

### 3단계: 파일 연결 설정
1. `UnlockOpenFile.exe`를 실행합니다 (인자 없이)
2. "Excel 파일 (.xlsx) 연결" 또는 "CSV 파일 (.csv) 연결" 버튼을 클릭합니다
3. 탐색기를 새로 고치거나 로그아웃 후 다시 로그인합니다

### 4단계: 파일 열기
Excel 또는 CSV 파일을 더블클릭하면 UnlockOpenFile을 통해 열립니다.

## 주요 기능 상세 설명

### 파일 복사 및 동기화
- 파일을 열면 자동으로 `C:\Users\[사용자]\AppData\Local\Temp`에 임시 복사본이 생성됩니다
- 복사본의 파일명: `원본파일명_copy_[타임스탬프].확장자`
- 복사본을 수정하면 약 500ms 후 자동으로 원본 파일에 변경 사항이 저장됩니다
- 파일 수정 시 "파일 수정됨" 알림이 표시되고, 저장 완료 시 "저장 완료" 알림이 표시됩니다
- 프로그램 종료 시 임시 파일은 자동으로 삭제됩니다

### 파일 연결 (File Association)
파일 형식을 UnlockOpenFile과 연결하면:
- 해당 형식의 파일을 더블클릭할 때 자동으로 UnlockOpenFile이 실행됩니다
- 원본 파일은 잠기지 않아 다른 프로그램도 접근할 수 있습니다
- 파일 아이콘이 변경될 수 있습니다

**지원 파일 형식:**
- Excel 파일 (`.xlsx`)
- CSV 파일 (`.csv`)

**파일 연결 위치:**
- 레지스트리: `HKEY_CURRENT_USER\Software\Classes`
- 관리자 권한 불필요

### 사용자 지정 응용 프로그램 설정
UnlockOpenFile을 통해 파일을 열 때 사용할 응용 프로그램을 직접 지정할 수 있습니다.

**설정 방법:**
1. 설정 창을 엽니다 (인자 없이 `UnlockOpenFile.exe` 실행)
2. "사용자 지정 응용 프로그램" 섹션에서 "추가/수정" 버튼을 클릭합니다
3. 파일 확장자를 입력합니다 (예: `.txt`, `.pdf`, `.docx`)
4. 해당 파일 형식을 열 응용 프로그램 실행 파일(.exe)을 선택합니다
5. 설정이 저장되고 목록에 표시됩니다

**제거 방법:**
1. 목록에서 제거할 항목을 선택합니다
2. "제거" 버튼을 클릭합니다

**동작 원리:**
- 설정된 확장자의 파일을 UnlockOpenFile로 열면 지정한 응용 프로그램으로 임시 파일이 열립니다
- 기본 Windows 파일 연결보다 우선순위가 높습니다
- 설정은 레지스트리 `HKEY_CURRENT_USER\Software\UnlockOpenFile\Applications`에 저장됩니다

**사용 예:**
- `.txt` 파일을 메모장 대신 Notepad++로 열기
- `.xlsx` 파일을 Excel 대신 LibreOffice Calc로 열기
- `.pdf` 파일을 Adobe Reader 대신 Chrome으로 열기


### 시작 프로그램 등록
Windows 시작 시 자동 실행을 원하는 경우:
1. 설정 창에서 "Windows 시작 시 자동 실행" 체크박스를 선택합니다
2. 레지스트리 `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`에 등록됩니다
3. Windows 재시작 후 백그라운드에서 자동으로 실행됩니다

### 시스템 트레이 아이콘
파일을 열면 시스템 트레이에 아이콘이 표시됩니다:
- 더블클릭: 상태 창 열기
- 우클릭: 컨텍스트 메뉴 (열기/종료)
- 상태 창 최소화: 트레이로 숨기기

## 사용 시나리오

### 시나리오 1: Excel 파일을 여러 프로그램에서 사용
**문제:** Excel로 파일을 열면 다른 프로그램(Python 스크립트, 데이터베이스 도구 등)에서 파일에 접근할 수 없습니다.

**해결:**
1. UnlockOpenFile로 Excel 파일을 엽니다
2. Excel에서 파일을 편집합니다
3. 동시에 Python 스크립트나 다른 프로그램에서 원본 파일을 읽을 수 있습니다
4. Excel에서 저장하면 자동으로 원본 파일에 반영됩니다

### 시나리오 2: CSV 파일 실시간 업데이트
**문제:** CSV 파일을 Excel로 열면 다른 프로그램이 파일을 업데이트할 수 없습니다.

**해결:**
1. UnlockOpenFile로 CSV 파일을 엽니다
2. Excel에서 데이터를 확인/편집합니다
3. 백그라운드 프로그램이 원본 CSV 파일을 업데이트할 수 있습니다
4. Excel에서의 변경 사항도 자동으로 저장됩니다

### 시나리오 3: 자동화 스크립트와 함께 사용
```batch
REM 배치 스크립트 예제
UnlockOpenFile.exe "C:\Data\report.xlsx"

REM 또는 PowerShell
Start-Process "UnlockOpenFile.exe" -ArgumentList "C:\Data\report.xlsx"
```

## 고급 설정

### 명령줄 사용
```bash
# 파일 열기
UnlockOpenFile.exe "경로\파일명.xlsx"

# 설정 창 열기
UnlockOpenFile.exe
```

### 파일 연결 수동 해제
Windows 설정에서도 파일 연결을 변경할 수 있습니다:
1. 설정 > 앱 > 기본 앱
2. 파일 형식별 기본 앱 선택
3. `.xlsx` 또는 `.csv`를 찾아 다른 프로그램으로 변경

### 레지스트리 직접 편집 (고급)
파일 연결을 수동으로 제거하려면:
```
HKEY_CURRENT_USER\Software\Classes\.xlsx
HKEY_CURRENT_USER\Software\Classes\UnlockOpenFile.xlsx
```
위 키들을 삭제하면 파일 연결이 해제됩니다.

## 문제 해결

### 파일이 열리지 않음
**원인:** .NET 8.0 Runtime이 설치되지 않았습니다.
**해결:** [.NET 8.0 Runtime 다운로드](https://dotnet.microsoft.com/download/dotnet/8.0)

### 변경 사항이 저장되지 않음
**원인 1:** 원본 파일이 읽기 전용입니다.
**해결 1:** 파일 속성에서 읽기 전용을 해제합니다.

**원인 2:** 파일이 다른 프로그램에서 쓰기 모드로 열려있습니다.
**해결 2:** 다른 프로그램을 닫거나 읽기 전용 모드로 엽니다.

**원인 3:** 파일 경로에 특수 문자가 있습니다.
**해결 3:** 파일명과 경로에 영문, 숫자만 사용합니다.

### 파일 연결이 작동하지 않음
**원인:** 탐색기 캐시가 업데이트되지 않았습니다.
**해결:**
1. 탐색기 프로세스 재시작 (작업 관리자에서 "Windows 탐색기" 재시작)
2. 또는 로그아웃 후 다시 로그인
3. 또는 컴퓨터 재시작

### 시스템 트레이 아이콘이 보이지 않음
**원인:** Windows 알림 영역 설정에서 숨김 처리되었습니다.
**해결:** 
1. 작업 표시줄 우클릭 > 작업 표시줄 설정
2. 알림 영역 > "작업 표시줄에 표시할 아이콘 선택"
3. UnlockOpenFile 아이콘 활성화

## 제한 사항

1. **Windows 전용**: 이 프로그램은 Windows 10 이상에서만 작동합니다
2. **임시 파일 공간**: 큰 파일을 열 때는 임시 폴더에 충분한 공간이 필요합니다
3. **동기화 지연**: 파일 변경 감지에 약 500ms의 지연이 있을 수 있습니다
4. **파일 형식 제한**: 모든 파일 형식이 기본 프로그램으로 열리는 것은 아닙니다

## 보안 고려사항

- 임시 파일은 시스템 임시 폴더에 생성되며, 다른 사용자가 접근할 수 없습니다
- 파일 연결은 사용자 레벨 레지스트리를 사용하므로 관리자 권한이 필요하지 않습니다
- 프로그램 종료 시 임시 파일이 자동으로 삭제됩니다
- 민감한 데이터를 다룰 때는 임시 폴더가 암호화된 드라이브에 있는지 확인하세요

## 성능 팁

1. **대용량 파일**: 100MB 이상의 파일은 복사에 시간이 걸릴 수 있습니다
2. **다중 파일**: 여러 파일을 동시에 여는 경우 각각의 복사본이 생성됩니다
3. **SSD 사용**: 임시 폴더가 SSD에 있으면 성능이 향상됩니다
4. **메모리**: 큰 파일을 여러 개 열 경우 충분한 RAM이 필요합니다

## 피드백 및 지원

문제가 발생하거나 기능 제안이 있으면 GitHub Issues에 등록해 주세요.
